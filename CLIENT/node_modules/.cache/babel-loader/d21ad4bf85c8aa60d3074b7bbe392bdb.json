{"ast":null,"code":"import _regeneratorRuntime from \"G:/CURSO HENRRY/PROYECTO FINAL/PF2/FRONT/14/PF-BarberApp/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"G:/CURSO HENRRY/PROYECTO FINAL/PF2/FRONT/14/PF-BarberApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\nvar _jsxFileName = \"G:\\\\CURSO HENRRY\\\\PROYECTO FINAL\\\\PF2\\\\FRONT\\\\14\\\\PF-BarberApp\\\\src\\\\components\\\\auth\\\\Google.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport { GoogleLogin } from \"@react-oauth/google\";\nimport { useDispatch } from \"react-redux\";\nimport { useHistory } from \"react-router-dom\";\nimport { fetchSinToken } from \"../../helpers/fetch\";\nimport { login } from \"../../redux/actions\";\nimport Swal from \"sweetalert2\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport var Google = function Google() {\n  _s();\n\n  var dispatch = useDispatch();\n  var history = useHistory();\n\n  var responseGoogle = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(response) {\n      var id_token, resp, data, payload;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              id_token = response.credential;\n              _context.next = 3;\n              return fetchSinToken(\"auth/google\", {\n                id_token: id_token\n              }, \"POST\");\n\n            case 3:\n              resp = _context.sent;\n              _context.next = 6;\n              return resp.json();\n\n            case 6:\n              data = _context.sent;\n\n              if (data.ok) {\n                payload = {\n                  id: data.id,\n                  email: data.email,\n                  name: data.name,\n                  rol: data.rol,\n                  img: data.img,\n                  phone: data.phone\n                };\n                localStorage.setItem(\"token\", data.token);\n                dispatch(login(payload));\n                history.replace(\"/\");\n              } else {\n                Swal.fire(\"Error\", data.msg, \"error\");\n              }\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function responseGoogle(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(GoogleLogin, {\n    clientId: \"\",\n    buttonText: \"Login\",\n    onSuccess: responseGoogle,\n    onFailure: responseGoogle,\n    cookiePolicy: \"single_host_origin\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 35,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(Google, \"FxNkVwM1QRg2/kU3+RDi4ll7EAM=\", false, function () {\n  return [useDispatch, useHistory];\n});\n\n_c = Google;\n\nvar _c;\n\n$RefreshReg$(_c, \"Google\");","map":{"version":3,"names":["React","GoogleLogin","useDispatch","useHistory","fetchSinToken","login","Swal","Google","dispatch","history","responseGoogle","response","id_token","credential","resp","json","data","ok","payload","id","email","name","rol","img","phone","localStorage","setItem","token","replace","fire","msg"],"sources":["G:/CURSO HENRRY/PROYECTO FINAL/PF2/FRONT/14/PF-BarberApp/src/components/auth/Google.js"],"sourcesContent":["import React from \"react\";\r\nimport { GoogleLogin } from \"@react-oauth/google\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { fetchSinToken } from \"../../helpers/fetch\";\r\nimport { login } from \"../../redux/actions\";\r\nimport Swal from \"sweetalert2\";\r\n\r\nexport const Google = () => {\r\n  const dispatch = useDispatch();\r\n  const history = useHistory();\r\n\r\n  const responseGoogle = async (response) => {\r\n    const id_token = response.credential;\r\n    const resp = await fetchSinToken(\"auth/google\", { id_token }, \"POST\");\r\n    const data = await resp.json();\r\n    if (data.ok) {\r\n      const payload = {\r\n        id: data.id,\r\n        email: data.email,\r\n        name: data.name,\r\n        rol: data.rol,\r\n        img: data.img,\r\n        phone: data.phone,\r\n      };\r\n      localStorage.setItem(\"token\", data.token);\r\n      dispatch(login(payload));\r\n      history.replace(\"/\");\r\n    } else {\r\n      Swal.fire(\"Error\", data.msg, \"error\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <GoogleLogin\r\n      clientId=\"\"\r\n      buttonText=\"Login\"\r\n      onSuccess={responseGoogle}\r\n      onFailure={responseGoogle}\r\n      cookiePolicy={\"single_host_origin\"}\r\n    />\r\n  );\r\n};\r\n"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,WAAT,QAA4B,qBAA5B;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAASC,aAAT,QAA8B,qBAA9B;AACA,SAASC,KAAT,QAAsB,qBAAtB;AACA,OAAOC,IAAP,MAAiB,aAAjB;;AAEA,OAAO,IAAMC,MAAM,GAAG,SAATA,MAAS,GAAM;EAAA;;EAC1B,IAAMC,QAAQ,GAAGN,WAAW,EAA5B;EACA,IAAMO,OAAO,GAAGN,UAAU,EAA1B;;EAEA,IAAMO,cAAc;IAAA,sEAAG,iBAAOC,QAAP;MAAA;MAAA;QAAA;UAAA;YAAA;cACfC,QADe,GACJD,QAAQ,CAACE,UADL;cAAA;cAAA,OAEFT,aAAa,CAAC,aAAD,EAAgB;gBAAEQ,QAAQ,EAARA;cAAF,CAAhB,EAA8B,MAA9B,CAFX;;YAAA;cAEfE,IAFe;cAAA;cAAA,OAGFA,IAAI,CAACC,IAAL,EAHE;;YAAA;cAGfC,IAHe;;cAIrB,IAAIA,IAAI,CAACC,EAAT,EAAa;gBACLC,OADK,GACK;kBACdC,EAAE,EAAEH,IAAI,CAACG,EADK;kBAEdC,KAAK,EAAEJ,IAAI,CAACI,KAFE;kBAGdC,IAAI,EAAEL,IAAI,CAACK,IAHG;kBAIdC,GAAG,EAAEN,IAAI,CAACM,GAJI;kBAKdC,GAAG,EAAEP,IAAI,CAACO,GALI;kBAMdC,KAAK,EAAER,IAAI,CAACQ;gBANE,CADL;gBASXC,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA8BV,IAAI,CAACW,KAAnC;gBACAnB,QAAQ,CAACH,KAAK,CAACa,OAAD,CAAN,CAAR;gBACAT,OAAO,CAACmB,OAAR,CAAgB,GAAhB;cACD,CAZD,MAYO;gBACLtB,IAAI,CAACuB,IAAL,CAAU,OAAV,EAAmBb,IAAI,CAACc,GAAxB,EAA6B,OAA7B;cACD;;YAlBoB;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CAAH;;IAAA,gBAAdpB,cAAc;MAAA;IAAA;EAAA,GAApB;;EAqBA,oBACE,QAAC,WAAD;IACE,QAAQ,EAAC,EADX;IAEE,UAAU,EAAC,OAFb;IAGE,SAAS,EAAEA,cAHb;IAIE,SAAS,EAAEA,cAJb;IAKE,YAAY,EAAE;EALhB;IAAA;IAAA;IAAA;EAAA,SADF;AASD,CAlCM;;GAAMH,M;UACML,W,EACDC,U;;;KAFLI,M"},"metadata":{},"sourceType":"module"}